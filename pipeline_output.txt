
============================================================
🎯 Privacy Filter → T5 Normalizer 파이프라인
============================================================
1단계: Privacy Filter (개인정보만 제거)
   - KLUE: soddokayo/klue-roberta-large-klue-ner
   - GLiNER: taeminlee/gliner_ko
2단계: T5 Normalizer (공백/맞춤법/문법)
   - T5: j5ng/et5-typos-corrector
============================================================


📋 문서 로더 지원 형식:
  - PDF: ✓ (텍스트 + OCR + 노이즈 제거)
  - TXT: ✓
  - Word (.docx): ✓
  - Word (.doc): ✓
  - PowerPoint (.pptx): ✓
  - PowerPoint (.ppt): ✓
  - Excel (.xlsx): ✓
  - Excel (.xls): ✓
  - CSV: ✓
  - HWP (.hwp/.hwpx): ✓
  - 이미지 (.jpg/.png): ✓ (OCR + 노이즈 제거)


🎯 KLUE 최고 성능 모델 자동 선택: soddokayo/klue-roberta-large-klue-ner
   F1: 0.836 | Precision: 0.829 | Recall: 0.844 | Accuracy: 96.6%

✓ 기본 텍스트 정제 모드 (공백 처리만)
✓ LangChain 분할 모드 활성화 (오버랩: 100자)

============================================================
🚀 Privacy → T5 순차 처리 파이프라인
============================================================
📁 대상 폴더: C:\Users\bravo\Desktop\test\data\raw
📊 발견된 파일: 4개

⚠️ 같은 이름, 다른 확장자 파일 발견:
   - 시스템 개발 프로젝트 회의록: .docx, .hwp
   → 각각 '파일명_확장자_chunks.json' 으로 저장됩니다
============================================================

[1/4]

============================================================
📄 처리 중: [회계팀] 경영손익모듈(손익보고) 관련 시스템 수정 요청.pdf
============================================================

[1단계] 문서 로드
  📑 PDF 1페이지
  ⚠️ 스캔본 감지 → 전체 OCR
  🔍 1페이지 OCR 처리 중 (노이즈 필터링)...
    페이지 1/1... ✓ (389자)

[2단계] 기본 텍스트 정제 (특수문자만)

[3단계] 청크 분할
  ✓ 총 1개 청크 생성

[4단계] Privacy Filter (개인정보만 제거)
  ⊘ Privacy Filter 비활성화

[5단계] T5 텍스트 정규화
  ⊘ T5 정규화 비활성화됨

[6단계] 최종 결과
  ✓ 텍스트 있는 청크: 1개
  ✓ 총 추출 문자: 389 자
  ✓ 평균 청크 크기: 389 자

  ✓ 저장 완료: data\chunks\[회계팀] 경영손익모듈(손익보고) 관련 시스템 수정 요청_pdf_chunks.json

[2/4]

============================================================
📄 처리 중: 이야기.pdf
============================================================

[1단계] 문서 로드
  📑 PDF 1페이지
  ✓ 텍스트 기반 PDF

[2단계] 기본 텍스트 정제 (특수문자만)

[3단계] 청크 분할
  ✓ 총 3개 청크 생성

[4단계] Privacy Filter (개인정보만 제거)
  ⊘ Privacy Filter 비활성화

[5단계] T5 텍스트 정규화
  ⊘ T5 정규화 비활성화됨

[6단계] 최종 결과
  ✓ 텍스트 있는 청크: 3개
  ✓ 총 추출 문자: 1,151 자
  ✓ 평균 청크 크기: 384 자

  ✓ 저장 완료: data\chunks\이야기_pdf_chunks.json

[3/4]

============================================================
📄 처리 중: 시스템 개발 프로젝트 회의록.docx
============================================================

[1단계] 문서 로드
  ❌ Word (.docx) 읽기 실패: File is not a zip file
  → 구버전 .doc 파일로 재시도
  ✓ Word (.doc) 읽기 완료 (2855자)

[2단계] 기본 텍스트 정제 (특수문자만)

[3단계] 청크 분할
  ✓ 총 8개 청크 생성

[4단계] Privacy Filter (개인정보만 제거)
  ⊘ Privacy Filter 비활성화

[5단계] T5 텍스트 정규화
  ⊘ T5 정규화 비활성화됨

[6단계] 최종 결과
  ✓ 텍스트 있는 청크: 8개
  ✓ 총 추출 문자: 3,365 자
  ✓ 평균 청크 크기: 421 자

  ✓ 저장 완료: data\chunks\시스템 개발 프로젝트 회의록_docx_chunks.json

[4/4]

============================================================
📄 처리 중: 시스템 개발 프로젝트 회의록.hwp
============================================================

[1단계] 문서 로드

  📄 HWP 파일 처리: 시스템 개발 프로젝트 회의록.hwp
  🔄 방법: HWP → PDF 변환 후 기존 PDF 로직 사용
  🔄 HWP → PDF 변환 시작...
  ✓ LibreOffice 발견: C:\Program Files\LibreOffice\program\soffice.exe
  🔧 실행 명령: C:\Program Files\LibreOffice\program\soffice.exe --headless --invisible --nodefault --nofirststartwizard --nolockcheck --nologo --norestore --convert-to pdf --outdir C:\Users\bravo\AppData\Local\Temp C:\Users\bravo\Desktop\test\data\raw\시스템 개발 프로젝트 회의록.hwp
  📤 stdout: (없음)
  📤 stderr: Could not find platform independent libraries <prefix>
Error: source file could not be loaded

  ❌ 변환 실패 - 출력 파일을 찾을 수 없음
     예상 경로: C:\Users\bravo\AppData\Local\Temp\시스템 개발 프로젝트 회의록.pdf
     Return code: 0
  ⚠️ PDF 변환 실패, 기존 방식(olefile) 시도...
  ✓ PrvText 섹션 추출 성공
  ✓ BodyText 섹션 추출 성공 (utf-16le)
  ✓ HWP 읽기 완료 (olefile 폴백, 3008자)

[2단계] 기본 텍스트 정제 (특수문자만)

[3단계] 청크 분할
  ✓ 총 9개 청크 생성

[4단계] Privacy Filter (개인정보만 제거)
  ⊘ Privacy Filter 비활성화

[5단계] T5 텍스트 정규화
  ⊘ T5 정규화 비활성화됨

[6단계] 최종 결과
  ✓ 텍스트 있는 청크: 9개
  ✓ 총 추출 문자: 3,557 자
  ✓ 평균 청크 크기: 395 자

  ✓ 저장 완료: data\chunks\시스템 개발 프로젝트 회의록_hwp_chunks.json

============================================================
✅ 처리 완료!
============================================================
  성공: 4/4개
  실패: 0개
  총 생성 청크: 21개
  총 추출 문자: 8,462자
  저장 위치: C:\Users\bravo\Desktop\test\data\chunks
============================================================

